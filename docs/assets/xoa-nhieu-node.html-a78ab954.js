import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as s,e}from"./app-a516acff.js";const t={},p=e(`<h1 id="xoa-nhieu-node-trong-drupal" tabindex="-1"><a class="header-anchor" href="#xoa-nhieu-node-trong-drupal" aria-hidden="true">#</a> Xóa nhiều node trong Drupal</h1><p>Đầu tiên chúng ta cần nid của các node cần xóa.</p><h2 id="đe-lay-nid-cua-cac-node-can-xoa-chung-ta-co-the-dung-entityquery-nhu-sau" tabindex="-1"><a class="header-anchor" href="#đe-lay-nid-cua-cac-node-can-xoa-chung-ta-co-the-dung-entityquery-nhu-sau" aria-hidden="true">#</a> Để lấy nid của các node cần xóa chúng ta co thể dùng entityQuery như sau:</h2><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token variable">$content_type</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;content_type_name&#39;</span><span class="token punctuation">;</span>
<span class="token variable">$nids</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\\</span>Drupal</span><span class="token operator">::</span><span class="token function">entityQuery</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;node&#39;</span><span class="token punctuation">)</span>
  <span class="token operator">-&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;type&#39;</span><span class="token punctuation">,</span> <span class="token variable">$content_type</span><span class="token punctuation">)</span>
  <span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="đe-xoa-nhieu-node-ta-co-the-dung-1-trong-2-cach-sau" tabindex="-1"><a class="header-anchor" href="#đe-xoa-nhieu-node-ta-co-the-dung-1-trong-2-cach-sau" aria-hidden="true">#</a> Để xóa nhiều node ta có thể dùng 1 trong 2 cách sau:</h2><h3 id="cach-1-lap-het-cac-node-va-xoa-tuan-tu" tabindex="-1"><a class="header-anchor" href="#cach-1-lap-het-cac-node-va-xoa-tuan-tu" aria-hidden="true">#</a> Cách 1: Lặp hết các node và xóa tuần tự</h3><p>Cách này xóa chậm hơn cách 2 nhưng phù hợp với các tác vụ đi kèm khi xóa node, ví dụ gửi mail và cần lấy các giá trị trong các field của node để bỏ vào nội dung mail chẳng hạn.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span>  <span class="token package"><span class="token punctuation">\\</span>Drupal<span class="token punctuation">\\</span>node<span class="token punctuation">\\</span>Entity<span class="token punctuation">\\</span>Node</span><span class="token punctuation">;</span>

<span class="token variable">$nodes</span> <span class="token operator">=</span> <span class="token class-name static-context">Node</span><span class="token operator">::</span><span class="token function">loadMultiple</span><span class="token punctuation">(</span><span class="token variable">$nids</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$nodes</span> <span class="token keyword">as</span> <span class="token variable">$node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$node</span><span class="token operator">-&gt;</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="cach-2-su-dung-storage-handler-đe-xoa" tabindex="-1"><a class="header-anchor" href="#cach-2-su-dung-storage-handler-đe-xoa" aria-hidden="true">#</a> Cách 2: Sử dụng storage handler để xóa</h3><p>Cách này xóa nhanh hơn cách 1, phù hợp với việc chỉ xóa node mà không làm gì thêm.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token variable">$storage_handler</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\\</span>Drupal</span><span class="token operator">::</span><span class="token function">entityTypeManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;node&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$entities</span> <span class="token operator">=</span> <span class="token variable">$storage_handler</span><span class="token operator">-&gt;</span><span class="token function">loadMultiple</span><span class="token punctuation">(</span><span class="token variable">$ids</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$storage_handler</span><span class="token operator">-&gt;</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token variable">$entities</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11),c=[p];function o(i,l){return a(),s("div",null,c)}const r=n(t,[["render",o],["__file","xoa-nhieu-node.html.vue"]]);export{r as default};
